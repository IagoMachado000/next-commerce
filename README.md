# Projeto Next E-commerce

## Estrutura de pastas padr√£o

`src/` - pasta raiz do c√≥digo-fonte do projeto
`src/app/` - cont√©m rotas, layouts e p√°ginas (mesma fun√ß√£o da `app/`)
`public/` - arquivos est√°ticos

## Estrutura de pasta custom

`src/app/componentes` - arquivos de componentes
`src/types` - tipagem dos dados

## Arquivos 

`src/app/layouts.tsx` - e o layout comum em todo a aplica√ß√£o

## Diferen√ßa na declara√ß√£o de componentes

A diferen√ßa entre a declara√ß√£o dos componentes √© **muito sutil** e est√° **apenas na sintaxe de declara√ß√£o**:

### üîπ 1. Fun√ß√£o declarada + export separado

```tsx
function Navbar() {
  return <nav>...</nav>;
}

export default Navbar;
```

‚úÖ Caracter√≠sticas:

* **Fun√ß√£o nomeada** ‚Üí ajuda no stack trace (erros mostram o nome `Navbar`).
* **Tem hoisting** ‚Üí voc√™ pode chamar `Navbar()` mesmo antes da declara√ß√£o.
* Separa√ß√£o clara entre **defini√ß√£o** e **exporta√ß√£o**.
* Com TypeScript, para tipar props voc√™ faz:

```tsx
type Props = { title: string };

function Navbar({ title }: Props) {
  return <nav>{title}</nav>;
}
```

### üîπ 2. Arrow function atribu√≠da a constante

```tsx
const Navbar = () => {
  return <nav>...</nav>;
};

export default Navbar;
```

‚úÖ Caracter√≠sticas:

* **Arrow function** ‚Üí n√£o tem hoisting. Voc√™ s√≥ pode usar `Navbar` depois dessa linha.
* Mais usada em **projetos modernos** porque combina bem com:

  * Hooks (`useState`, `useEffect`, etc.).
  * Tipagem expl√≠cita (`const Comp: React.FC<Props> = ...`).
* Tamb√©m mant√©m o nome da fun√ß√£o (`Navbar`) nos erros, porque est√° atribu√≠da a uma vari√°vel.

```tsx
type Props = { title: string };

const Navbar = ({ title }: Props) => {
  return <nav>{title}</nav>;
};
```

### üîπ 3. Fun√ß√£o declarada com `export default`

```tsx
export default function Navbar() {
  return <nav>...</nav>;
}
```

‚úÖ Caracter√≠sticas:

* Mesma ideia da 1¬™, mas j√° **exporta direto**.
* C√≥digo mais **enxuto**, usado muito em exemplos oficiais do Next.js.
* Continua sendo uma fun√ß√£o nomeada ‚Üí nos erros ainda aparece `Navbar`.
* Com TypeScript, tipar props √© id√™ntico:

```tsx
type Props = { title: string };

export default function Navbar({ title }: Props) {
  return <nav>{title}</nav>;
}
```

### üìå Compara√ß√£o final

| Forma                                 | Hoisting | Legibilidade          | Estilo comum em‚Ä¶                                     |
| ------------------------------------- | -------- | --------------------- | ---------------------------------------------------- |
| `function Navbar() {}` + export       | ‚úÖ Sim    | Separa√ß√£o clara       | Projetos mais cl√°ssicos, libs                        |
| `const Navbar = () => {}`             | ‚ùå N√£o    | Mais conciso, moderno | Projetos atuais, quando se usa hooks e props tipadas |
| `export default function Navbar() {}` | ‚úÖ Sim    | Mais enxuto           | Next.js docs, exemplos oficiais                      |

üëâ **Na pr√°tica:**

* As **3 funcionam exatamente igual** em React.
* A diferen√ßa √© s√≥ de estilo e de como voc√™ organiza o projeto.
* Se estiver em Next.js, a **3¬™** √© a mais comum nos exemplos da documenta√ß√£o.
* Se quiser **tipagem expl√≠cita e controle total**, a **2¬™** (arrow function) √© a preferida em times grandes.

---

## Estrutura de um componente com tipagem

```ts
// ======= src/types/ProductType.ts =======

// Tipagem do objeto Produto
export type ProductType = {
  id: number;                // Identificador √∫nico
  title: string;             // Nome do produto
  price: number | null;      // Pre√ßo (pode ser null)
  description: string | null; // Descri√ß√£o do produto
  image: string;             // URL da imagem
  category: string;          // Categoria do produto
};
```

```ts
// ======= src/app/components/Product.tsx =======

import { ProductType } from "@/types/ProductType";

// Define o tipo das props do componente Product
type ProductProps = {
  product: ProductType; // Recebe um produto do tipo ProductType
};

// Componente funcional Product que recebe um produto como prop
const Product = ({ product }: ProductProps) => {
  return (
    // Container principal do card do produto
    <div className="flex flex-col shadow-lg h-96 bg-slate-800 p-5 text-gray-300">
      
      {/* Imagem do produto */}
      <div className="relative max-h-72 flex-1">
        {/* Aqui voc√™ poderia colocar <img src={product.image} alt={product.title}/> */}
      </div>

      {/* Pre√ßo do produto */}
      <div className="flex justify-between font-bold my-3">
        {product.price}
      </div>

      {/* Descri√ß√£o do produto */}
      <div>
        {product.description}
      </div>

      {/* Bot√£o de a√ß√£o */}
      <button className="rounded-md bg-teal-600 text-white px-3.5 py-2.5 text-sm text-center">
        Comprar
      </button>
    </div>
  );
};

export default Product;
```

```ts
// ======= src/app/page.tsx =======

// Exemplo de uso do componente Product em um componente pai
// products √© um array de objetos do tipo ProductType
{products.map((product: ProductType) => (
  // Para cada produto, renderiza um componente Product
  // key={product.id} √© necess√°rio para identificar cada item na lista
  <Product key={product.id} product={product} />
))}
```

### ‚úÖ Ordem l√≥gica explicada com arquivos

1. **`src/types/ProductType.ts`** ‚Üí define o tipo `ProductType`.
2. **`src/app/components/Product.tsx`** ‚Üí cria o card do produto (`Product`).
3. **`src/app/page.tsx`** ‚Üí componente pai que mapeia o array e renderiza v√°rios `Product`.

---

## Imagens

### Imagens locais

Se as imagens forem servidas localmente, dentro do pr√≥prio app, n√£o √© necess√°rio nenhuma configura√ß√£o adicional

```tsx
import Image from 'next/image';

<Image
  src="/images/produto1.png" // caminho relativo dentro de public
  width={300}
  height={300}
  alt="Produto 1"
/>
```

### Imagens externas

- Para imagens que v√™m de outros dom√≠nios (API, CDN), o Next.js precisa saber quais dom√≠nios s√£o confi√°veis.

- Em vers√µes antigas (<15), usava-se images.domains.

- Agora, em Next.js 15+, usa-se images.remotePatterns.

```tsx
import { NextConfig } from 'next';

const nextConfig: NextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',           // protocolo da URL (http ou https)
        hostname: 'fakestoreapi.com', // dom√≠nio de onde vir√£o as imagens
        port: '',                    // opcional, normalmente vazio
        pathname: '/**',             // permite todos os caminhos
      },
    ],
  },
};

export default nextConfig;

import Image from 'next/image';

<Image
  src="https://fakestoreapi.com/img/produto1.jpg" // imagem externa
  width={300}
  height={300}
  alt="Produto 1"
/>

// Sem essa configura√ß√£o, o Next.js dar√° erro ou aviso.
```

## `use cliente`

No **Next.js (App Router)**, por padr√£o, todos os arquivos em `app/` s√£o **Server Components**. Isso significa que:

* Eles **rodam no servidor** antes de enviar o HTML para o navegador.
* N√£o t√™m acesso a hooks do React que dependem do browser (`useState`, `useEffect`, etc.).
* Podem acessar dados sens√≠veis (ex.: `process.env.STRIPE_SECRET_KEY`).

### üîë O que faz o `"use client"`

Se voc√™ coloca no topo do arquivo:

```tsx
"use client";
```

Voc√™ est√° dizendo para o Next.js:

> ‚ÄúEsse componente deve ser renderizado no **cliente (browser)** e n√£o apenas no servidor.‚Äù

Assim ele vira um **Client Component**.

### ‚ú® Diferen√ßas pr√°ticas entre **Server Component** e **Client Component**

| Caracter√≠stica                                  | Server Component                         | Client Component                               |
| ----------------------------------------------- | ---------------------------------------- | ---------------------------------------------- |
| Onde roda                                       | No servidor                              | No navegador                                   |
| Pode usar `useState`, `useEffect`, `useContext` | ‚ùå N√£o                                    | ‚úÖ Sim                                          |
| Pode acessar vari√°veis secretas (`process.env`) | ‚úÖ Sim                                    | ‚ùå N√£o                                          |
| Tamanho do bundle enviado ao cliente            | Menor                                    | Maior                                          |
| Exemplo t√≠pico                                  | Pegar dados no banco, renderizar produto | Bot√£o de adicionar ao carrinho, interatividade |

### üìå Exemplos

#### Server Component (padr√£o)

```tsx
// app/page.tsx (n√£o precisa "use client")
export default async function Page() {
  const products = await getProducts(); // pode acessar banco, API privada
  return <div>{products.map(p => <div>{p.name}</div>)}</div>;
}
```

#### Client Component

```tsx
"use client";

import { useState } from "react";

export default function Counter() {
  const [count, setCount] = useState(0); // s√≥ funciona com "use client"
  return (
    <button onClick={() => setCount(count + 1)}>
      Cliquei {count} vezes
    </button>
  );
}
```

‚úÖ **Resumindo**:

* Use **Server Components** sempre que poss√≠vel (melhor performance, acesso a dados sens√≠veis).
* Use **Client Components** (`"use client"`) apenas quando precisar de **interatividade no browser**.

---

## App Route

### üìå O que √© o `page.tsx`?

Dentro do **App Router (`app/`)**, cada pasta corresponde a uma **rota**.
E o arquivo `page.tsx` √© o **ponto de entrada principal dessa rota**.

Exemplo:

```
src/app/products/page.tsx
```

‚û°Ô∏è Isso cria a rota:

```
http://localhost:3000/products
```

O conte√∫do de `page.tsx` ser√° renderizado quando voc√™ acessar `/products`.

### üìÇ O que pode ter dentro de `src/app/products/`

Al√©m de `page.tsx`, a pasta de uma rota pode conter v√°rios arquivos especiais:

| Arquivo                       | Fun√ß√£o                                                                                                 |
| ----------------------------- | ------------------------------------------------------------------------------------------------------ |
| **page.tsx**                  | Renderiza a p√°gina principal da rota (`/products`).                                                    |
| **layout.tsx**                | Define a estrutura visual compartilhada entre sub-rotas (navbar, sidebar, footer, etc.).               |
| **loading.tsx**               | Mostra um *loading state* enquanto o conte√∫do da rota est√° sendo carregado (ideal para SSR/streaming). |
| **error.tsx**                 | Renderiza um fallback em caso de erro nessa rota.                                                      |
| **not-found.tsx**             | Mostra uma p√°gina de "404" espec√≠fica para essa rota.                                                  |
| **head.tsx** (opcional)       | Personaliza `<head>` (t√≠tulo, meta tags).                                                              |
| **route.ts** ou **route.tsx** | Usado para criar **API Routes** dentro do App Router (ex.: `/products/api`).                           |

### ‚öôÔ∏è Como funciona o roteamento no App Router

1. **Cada pasta dentro de `app/` vira uma rota.**

   * `src/app/page.tsx` ‚Üí `/`
   * `src/app/products/page.tsx` ‚Üí `/products`
   * `src/app/products/[id]/page.tsx` ‚Üí `/products/:id` (rota din√¢mica)
   * `src/app/dashboard/settings/page.tsx` ‚Üí `/dashboard/settings`

2. **Layouts s√£o hier√°rquicos.**

   * Se voc√™ tiver `src/app/layout.tsx`, ele √© aplicado a **todas as rotas**.
   * Se tiver `src/app/products/layout.tsx`, ele √© aplicado s√≥ a `/products` e suas subrotas.

3. **Carregamento e erros s√£o isolados.**

   * Se voc√™ definir `loading.tsx` em `/products`, s√≥ essa rota mostra o loading.
   * O mesmo vale para `error.tsx`.

### üß© Exemplo pr√°tico

Estrutura:

```
src/app/
 ‚îú‚îÄ layout.tsx        // Layout global (header/footer do site inteiro)
 ‚îú‚îÄ page.tsx          // P√°gina inicial "/"
 ‚îú‚îÄ products/
 ‚îÇ   ‚îú‚îÄ page.tsx      // P√°gina "/products"
 ‚îÇ   ‚îú‚îÄ layout.tsx    // Layout s√≥ para a se√ß√£o de produtos
 ‚îÇ   ‚îú‚îÄ loading.tsx   // Loader exclusivo de /products
 ‚îÇ   ‚îú‚îÄ error.tsx     // Tratamento de erro em /products
 ‚îÇ   ‚îî‚îÄ [id]/
 ‚îÇ       ‚îî‚îÄ page.tsx  // P√°gina din√¢mica "/products/:id"
```

üëâ Quando o usu√°rio acessa `/products/123`, o Next vai:

1. Renderizar `src/app/layout.tsx` (layout global).
2. Renderizar `src/app/products/layout.tsx` (layout da se√ß√£o de produtos).
3. Renderizar `src/app/products/[id]/page.tsx` (p√°gina espec√≠fica do produto).

‚úÖ **Resumindo**:

* `page.tsx` = p√°gina principal da rota.
* Cada pasta em `app/` representa uma rota.
* Voc√™ pode ter `layout.tsx`, `loading.tsx`, `error.tsx`, `not-found.tsx` etc. para controlar o comportamento da rota.
* O roteamento √© **file-based** (baseado na estrutura de pastas).

---

## Arquivos `.ts` e `.tsx`

No **Next.js** (ou qualquer projeto React/TypeScript), a diferen√ßa entre **`.ts`** e **`.tsx`** √© a seguinte:

### üìå Arquivos `.ts`

* S√£o arquivos **TypeScript puro** (sem JSX).
* Usados para **l√≥gica, utilit√°rios, configs, tipos, hooks sem JSX**.
* Exemplos t√≠picos:

  * `src/lib/db.ts` ‚Üí conex√£o com banco
  * `src/utils/formatPrice.ts` ‚Üí fun√ß√µes helpers
  * `src/types/Product.ts` ‚Üí defini√ß√£o de tipos/interfaces
  * `src/services/api.ts` ‚Üí chamadas a API

```ts
// src/utils/formatPrice.ts
export function formatPrice(value: number, currency = "USD") {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency,
  }).format(value / 100);
}
```

### üìå Arquivos `.tsx`

* S√£o arquivos **TypeScript + JSX (TSX)**.
* Usados para **componentes React**, **layouts** e **p√°ginas** do Next.js.
* Qualquer arquivo que renderize elementos JSX (`<div>`, `<button>`, etc.) precisa ser `.tsx`.
* Exemplos t√≠picos:

  * `src/app/page.tsx` ‚Üí p√°gina principal `/`
  * `src/app/products/page.tsx` ‚Üí rota `/products`
  * `src/components/Navbar.tsx` ‚Üí componente de navega√ß√£o
  * `src/app/layout.tsx` ‚Üí layout de p√°gina

```tsx
// src/components/Button.tsx
type ButtonProps = {
  children: React.ReactNode;
  onClick?: () => void;
};

export default function Button({ children, onClick }: ButtonProps) {
  return (
    <button
      onClick={onClick}
      className="rounded bg-blue-500 px-4 py-2 text-white"
    >
      {children}
    </button>
  );
}
```

### üöÄ Regrinha pr√°tica no Next.js

* **Se o arquivo tiver JSX ‚Üí `.tsx`**
  (componentes, p√°ginas, layouts, providers, etc.)

* **Se o arquivo n√£o tiver JSX ‚Üí `.ts`**
  (fun√ß√µes helpers, servi√ßos, hooks sem renderiza√ß√£o, schemas, tipos, configs, etc.)

üëâ Exemplo na pr√°tica do Next.js:

```
src/
 ‚îú‚îÄ app/
 ‚îÇ   ‚îú‚îÄ layout.tsx      ‚úÖ tem JSX ‚Üí TSX
 ‚îÇ   ‚îú‚îÄ page.tsx        ‚úÖ tem JSX ‚Üí TSX
 ‚îÇ   ‚îî‚îÄ products/
 ‚îÇ       ‚îî‚îÄ page.tsx    ‚úÖ tem JSX ‚Üí TSX
 ‚îÇ
 ‚îú‚îÄ components/
 ‚îÇ   ‚îî‚îÄ Navbar.tsx      ‚úÖ componente React ‚Üí TSX
 ‚îÇ
 ‚îú‚îÄ lib/
 ‚îÇ   ‚îî‚îÄ stripe.ts       ‚úÖ l√≥gica do Stripe (sem JSX) ‚Üí TS
 ‚îÇ
 ‚îú‚îÄ types/
 ‚îÇ   ‚îî‚îÄ product.ts      ‚úÖ apenas tipos/interfaces ‚Üí TS
 ‚îÇ
 ‚îî‚îÄ utils/
     ‚îî‚îÄ formatPrice.ts  ‚úÖ helper (sem JSX) ‚Üí TS
```

‚ö° **Resumindo**:

* Use `.tsx` **sempre que for escrever um componente React ou p√°gina/layout no Next.js**.
* Use `.ts` **para tudo que n√£o renderiza JSX** (tipos, utilit√°rios, l√≥gica de backend, configs).

---

